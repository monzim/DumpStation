# ============================================
# DumpStation Production Environment Template
# ============================================
# This is a production-hardened configuration template
# Use this for production deployments with enhanced security
# ============================================

# ============================================
# üîí SECURITY CRITICAL - CHANGE ALL VALUES
# ============================================

# PostgreSQL (DumpStation's Internal Database)
POSTGRES_DB=backup_service
POSTGRES_USER=dumpstation_user
# Generate: openssl rand -base64 32
POSTGRES_PASSWORD=

# JWT Secret - MUST be strong random value
# Generate: openssl rand -base64 64
JWT_SECRET=
JWT_EXPIRATION_MINUTES=10

# Discord Webhook (Required for Authentication)
# Create at: Server Settings -> Integrations -> Webhooks
DISCORD_WEBHOOK_URL=
OTP_EXPIRATION_MINUTES=5

# ============================================
# üõ°Ô∏è Bot Protection (Cloudflare Turnstile)
# ============================================
# Highly recommended for production
# Get keys from: https://dash.cloudflare.com/?to=/:account/turnstile

TURNSTILE_ENABLED=true
# Your production site key
TURNSTILE_SITE_KEY=
# Your production secret key
TURNSTILE_SECRET_KEY=
TURNSTILE_TIMEOUT=10

# ============================================
# üåê CORS Configuration (Production)
# ============================================
# IMPORTANT: Set to your actual domain(s), NO wildcards!
# Multiple domains: separate with commas (no spaces)

# Your production domain(s)
CORS_ALLOWED_ORIGINS=https://dumpstation.yourdomain.com

# HTTP methods (default is usually fine)
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH

# Headers (add custom headers if needed)
CORS_ALLOWED_HEADERS=Origin,Content-Type,Accept,Authorization,X-Requested-With,X-2FA-Token

# Allow credentials (required for cookies/auth)
CORS_ALLOW_CREDENTIALS=true

# Preflight cache duration (24 hours)
CORS_MAX_AGE=86400

# Disable CORS debug in production
CORS_DEBUG=false

# ============================================
# üë§ System Admin User
# ============================================
# Initial admin account created on first startup

SYSTEM_USERNAME=admin
SYSTEM_EMAIL=admin@yourdomain.com

# ============================================
# üîå Service Ports (External)
# ============================================
# Ports exposed to the host machine
# Recommendation: Use reverse proxy (Nginx/Caddy) and don't expose these publicly

# Backend API port
BACKEND_PORT=8080

# Web frontend port
WEB_PORT=3000

# ============================================
# üåç Frontend Configuration
# ============================================
# API endpoint that frontend will connect to
# Should match your reverse proxy configuration

# For production with reverse proxy
VITE_API_BASE_URL=https://api.yourdomain.com/api/v1

# Or direct access (not recommended)
# VITE_API_BASE_URL=https://your-server-ip:8080/api/v1

# ============================================
# üíæ MinIO Configuration (Optional)
# ============================================
# Uncomment if using MinIO for local S3 storage
# For production, AWS S3 or Cloudflare R2 is recommended

# MINIO_ROOT_USER=minio_admin
# Generate: openssl rand -base64 24
# MINIO_ROOT_PASSWORD=
# MINIO_API_PORT=9000
# MINIO_CONSOLE_PORT=9001

# ============================================
# üìä Production Deployment Checklist
# ============================================
# Before going live, ensure:
#
# ‚úÖ Security:
#    [ ] All passwords changed from defaults
#    [ ] JWT_SECRET is strong random value (64+ chars)
#    [ ] POSTGRES_PASSWORD is strong (32+ chars)
#    [ ] TURNSTILE_ENABLED=true with production keys
#    [ ] CORS_ALLOWED_ORIGINS set to actual domain (no wildcards)
#    [ ] CORS_DEBUG=false
#
# ‚úÖ Infrastructure:
#    [ ] Reverse proxy (Nginx/Caddy) configured
#    [ ] SSL/TLS certificate installed (Let's Encrypt)
#    [ ] Firewall configured (only 22, 80, 443 exposed)
#    [ ] DNS records configured correctly
#    [ ] Domain name pointing to server
#
# ‚úÖ Monitoring:
#    [ ] Log aggregation configured
#    [ ] Health check monitoring active
#    [ ] Disk space alerts configured
#    [ ] Backup automation configured
#    [ ] Discord webhook tested
#
# ‚úÖ Backups:
#    [ ] Automated backup script scheduled
#    [ ] Backup retention policy defined
#    [ ] Restore procedure tested
#    [ ] Off-site backup storage configured
#
# ‚úÖ Documentation:
#    [ ] Deployment documented for team
#    [ ] Disaster recovery plan created
#    [ ] Access credentials stored securely
#    [ ] Runbook created for common tasks
#
# ============================================
# üîê Security Best Practices
# ============================================
#
# 1. Never commit .env file to version control
#    Add to .gitignore: .env
#
# 2. Rotate secrets periodically
#    - JWT_SECRET: Every 90 days
#    - POSTGRES_PASSWORD: Every 180 days
#
# 3. Use reverse proxy with SSL/TLS
#    Don't expose backend/web ports directly
#
# 4. Enable Turnstile in production
#    Prevents automated attacks
#
# 5. Restrict CORS to your domain only
#    Never use '*' in production
#
# 6. Keep Docker images updated
#    Run: docker-compose pull weekly
#
# 7. Monitor logs for suspicious activity
#    Check: docker-compose logs regularly
#
# 8. Backup database regularly
#    Automate: ./manage.sh backup (daily)
#
# 9. Use strong, unique passwords
#    Generate: openssl rand -base64 32
#
# 10. Limit container resources
#     Add deploy.resources in compose.yml
#
# ============================================
# üìö Quick Reference
# ============================================
#
# Generate secure secrets:
#   openssl rand -base64 64     # JWT secret
#   openssl rand -base64 32     # Passwords
#   openssl rand -hex 32        # API keys
#
# Test configuration:
#   docker-compose config
#
# Start services:
#   ./deploy.sh
#   # or
#   docker-compose up -d
#
# View logs:
#   ./manage.sh logs -f
#
# Backup database:
#   ./manage.sh backup
#
# Health check:
#   ./manage.sh health
#
# Update to latest:
#   ./manage.sh update
#
# ============================================
